{
  "category": "privacy",
  "test_name": "Privacy Compliance (PIPEDA/CCPA/CPRA/HIPAA)",
  "score": 45.83333333333333,
  "passed": false,
  "total_tests": 24,
  "passed_tests": 11,
  "failed_tests": 13,
  "execution_time": 0.4879448413848877,
  "test_results": [
    {
      "test_name": "api_authorization_enforced",
      "passed": false,
      "message": "Found 2 views that may lack authorization",
      "details": {
        "violations": [
          "admin_dashboard.py may lack authorization checks",
          "pages.py may lack authorization checks"
        ]
      }
    },
    {
      "test_name": "api_input_validation",
      "passed": false,
      "message": "Found 1 views that may lack input validation",
      "details": {
        "violations": [
          "admin_dashboard.py may lack input validation"
        ]
      }
    },
    {
      "test_name": "api_no_internal_ids_exposed",
      "passed": true,
      "message": "API ID exposure check (requires manual review)",
      "details": {
        "note": "Full validation requires API response inspection"
      }
    },
    {
      "test_name": "ccpa_no_selling_data",
      "passed": true,
      "message": "No unauthorized data sharing detected",
      "details": {
        "violations": []
      }
    },
    {
      "test_name": "ccpa_right_to_delete",
      "passed": false,
      "message": "No account deletion endpoint found (Right to Delete)",
      "details": {
        "endpoints": []
      }
    },
    {
      "test_name": "ccpa_right_to_know",
      "passed": false,
      "message": "No data export endpoint found (Right to Know)",
      "details": {
        "endpoints": []
      }
    },
    {
      "test_name": "consent_deletion_path",
      "passed": false,
      "message": "Missing deletion paths for user data",
      "details": {
        "deletion_paths": []
      }
    },
    {
      "test_name": "consent_purpose_documentation",
      "passed": true,
      "message": "All models have purpose documentation",
      "details": {
        "violations": []
      }
    },
    {
      "test_name": "data_deletion_complete",
      "passed": true,
      "message": "User deletion properly cascades",
      "details": {
        "issues": []
      }
    },
    {
      "test_name": "data_minimization_identifier_hashing",
      "passed": true,
      "message": "All identifiers properly hashed",
      "details": {
        "violations": []
      }
    },
    {
      "test_name": "data_minimization_unnecessary_fields",
      "passed": false,
      "message": "Found 9 unnecessary PII fields",
      "details": {
        "violations": [
          "Payment.stripe_payment_intent_id",
          "SubscriptionPlan.description",
          "SubscriptionPlan.stripe_price_id_monthly",
          "SubscriptionPlan.stripe_price_id_yearly",
          "UserProfile.subscription_type",
          "UserProfile.subscription_start",
          "UserProfile.subscription_end",
          "UserProfile.stripe_customer_id",
          "UserProfile.stripe_subscription_id"
        ]
      }
    },
    {
      "test_name": "data_retention_defined",
      "passed": true,
      "message": "Data retention mechanisms found",
      "details": {
        "retention_mechanisms": true
      }
    },
    {
      "test_name": "documentation_data_collection",
      "passed": false,
      "message": "Found 9 models missing data collection documentation",
      "details": {
        "violations": [
          "AIFineTuningCommand collects data but docstring doesn't explain",
          "AIFineTuningTemplate collects data but docstring doesn't explain",
          "Page collects data but docstring doesn't explain",
          "Payment collects data but docstring doesn't explain",
          "PrivacyPolicy collects data but docstring doesn't explain",
          "SubscriptionPlan collects data but docstring doesn't explain",
          "SubscriptionTierSettings collects data but docstring doesn't explain",
          "TermsOfService collects data but docstring doesn't explain",
          "TestResult collects data but docstring doesn't explain"
        ]
      }
    },
    {
      "test_name": "documentation_retention_deletion",
      "passed": false,
      "message": "No privacy documentation found",
      "details": {
        "docs": []
      }
    },
    {
      "test_name": "encryption_at_rest_sensitive_fields",
      "passed": false,
      "message": "Found 3 unencrypted sensitive fields",
      "details": {
        "violations": [
          "Page.meta_keywords",
          "SubscriptionPlan.tier_key",
          "ENCRYPT_DATASETS setting is False"
        ],
        "encryption_enabled": false
      }
    },
    {
      "test_name": "encryption_in_transit_https",
      "passed": false,
      "message": "HTTPS not fully enforced: USE_SSL is False, SESSION_COOKIE_SECURE is False, CSRF_COOKIE_SECURE is False",
      "details": {
        "violations": [
          "USE_SSL is False",
          "SESSION_COOKIE_SECURE is False",
          "CSRF_COOKIE_SECURE is False"
        ],
        "debug_mode": false
      }
    },
    {
      "test_name": "encryption_no_plaintext_secrets",
      "passed": true,
      "message": "No plaintext secrets in code",
      "details": {
        "violations": []
      }
    },
    {
      "test_name": "logging_no_pii_in_logs",
      "passed": false,
      "message": "Found 10 potential PII in logs",
      "details": {
        "violations": [
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:215 - Potential PII in log: print(f\"DEBUG: Multinomial diagnostics calculated - disp={disp}, max_resid={max_resid}, n_classes={n",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:395 - Potential PII in log: print(f\"DEBUG: Found interaction term: {interaction_name} (parts: {combo})\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:713 - Potential PII in log: print(f\"DEBUG: Added missing variable '{target_name}' to grid (from formula var '{var_name}')\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:721 - Potential PII in log: print(f\"DEBUG: Added missing variable '{target_name}' to grid (fallback)\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:757 - Potential PII in log: print(f\"DEBUG: Model exog_names: {model.model.exog_names}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:774 - Potential PII in log: print(f\"DEBUG: Added '{var_name}' from grid to complete_grid: dtype={values.dtype}, sample={values.i",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:785 - Potential PII in log: print(f\"DEBUG: Used categorical value '{var_name}' in complete grid: {mode_val.iloc[0]}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:843 - Potential PII in log: print(f\"DEBUG: Model parameter names: {list(model.params.index)}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:850 - Potential PII in log: print(f\"DEBUG: Processing variable '{var_name}' for ordinal grid\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:854 - Potential PII in log: print(f\"DEBUG: Preserved x-axis variation for '{var_name}' from original grid\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:855 - Potential PII in log: print(f\"DEBUG:   - Values range: {grid[var_name].min()} to {grid[var_name].max()}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:856 - Potential PII in log: print(f\"DEBUG:   - Unique values: {grid[var_name].nunique()}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:859 - Potential PII in log: print(f\"DEBUG: Used '{var_name}' from complete_grid\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:864 - Potential PII in log: print(f\"DEBUG: Used mean value for numeric '{var_name}': {mean_val}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:868 - Potential PII in log: print(f\"DEBUG: Used mode value for categorical '{var_name}': {mode_val}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:875 - Potential PII in log: print(f\"DEBUG: Set dummy variable '{var_name}' to 0.0 (categorical encoding)\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:885 - Potential PII in log: print(f\"DEBUG: Found similar variable '{actual_var}' for '{var_name}', used mean: {mean_val}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:889 - Potential PII in log: print(f\"DEBUG: Found similar variable '{actual_var}' for '{var_name}', used mode: {mode_val}\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:893 - Potential PII in log: print(f\"DEBUG: Set missing variable '{var_name}' to 0.0 (no similar variable found)\")",
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py:926 - Potential PII in log: print(f\"DEBUG: Model exog_names: {model.model.exog_names}\")"
        ]
      }
    },
    {
      "test_name": "logging_pii_masking",
      "passed": true,
      "message": "Found 3 files with masking utilities",
      "details": {
        "masking_files": [
          "/Users/pooryaselkghafari/Desktop/GRA/models/regression.py",
          "/Users/pooryaselkghafari/Desktop/GRA/models/ANOVA.py",
          "/Users/pooryaselkghafari/Desktop/GRA/models/VARX.py"
        ]
      }
    },
    {
      "test_name": "pii_identification_sensitive_fields",
      "passed": true,
      "message": "Identified PII in 13 models",
      "details": {
        "pii_fields": {
          "AIFineTuningCommand": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "description",
              "type": "ip",
              "encrypted": false
            }
          ],
          "AIFineTuningFile": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "name",
              "type": "name",
              "encrypted": false
            },
            {
              "field": "description",
              "type": "ip",
              "encrypted": false
            }
          ],
          "AIFineTuningTemplate": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "name",
              "type": "name",
              "encrypted": false
            },
            {
              "field": "description",
              "type": "ip",
              "encrypted": false
            }
          ],
          "AnalysisSession": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "name",
              "type": "name",
              "encrypted": false
            }
          ],
          "Dataset": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "name",
              "type": "name",
              "encrypted": false
            }
          ],
          "Page": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "page_type",
              "type": "dob",
              "encrypted": false
            },
            {
              "field": "meta_description",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "og_description",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "og_image",
              "type": "dob",
              "encrypted": false
            },
            {
              "field": "template_name",
              "type": "name",
              "encrypted": false
            }
          ],
          "Payment": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "stripe_payment_intent_id",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_payment_intent_id",
              "type": "financial",
              "encrypted": false
            },
            {
              "field": "stripe_payment_intent_id",
              "type": "identifier",
              "encrypted": false
            }
          ],
          "PrivacyPolicy": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            }
          ],
          "SubscriptionPlan": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "name",
              "type": "name",
              "encrypted": false
            },
            {
              "field": "description",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_price_id_monthly",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_price_id_monthly",
              "type": "financial",
              "encrypted": false
            },
            {
              "field": "stripe_price_id_monthly",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "stripe_price_id_yearly",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_price_id_yearly",
              "type": "financial",
              "encrypted": false
            },
            {
              "field": "stripe_price_id_yearly",
              "type": "identifier",
              "encrypted": false
            }
          ],
          "SubscriptionTierSettings": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "description",
              "type": "ip",
              "encrypted": false
            }
          ],
          "TermsOfService": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            }
          ],
          "TestResult": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "test_name",
              "type": "name",
              "encrypted": false
            },
            {
              "field": "error_message",
              "type": "dob",
              "encrypted": false
            }
          ],
          "UserProfile": [
            {
              "field": "id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "subscription_type",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "subscription_start",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "subscription_end",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_customer_id",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_customer_id",
              "type": "financial",
              "encrypted": false
            },
            {
              "field": "stripe_customer_id",
              "type": "identifier",
              "encrypted": false
            },
            {
              "field": "stripe_subscription_id",
              "type": "ip",
              "encrypted": false
            },
            {
              "field": "stripe_subscription_id",
              "type": "financial",
              "encrypted": false
            },
            {
              "field": "stripe_subscription_id",
              "type": "identifier",
              "encrypted": false
            }
          ]
        }
      }
    },
    {
      "test_name": "pii_no_plaintext_passwords",
      "passed": true,
      "message": "No plaintext passwords found",
      "details": {
        "violations": []
      }
    },
    {
      "test_name": "pipeda_minimal_data_collection",
      "passed": true,
      "message": "Only minimal required data collected",
      "details": {
        "violations": []
      }
    },
    {
      "test_name": "pipeda_purpose_identification",
      "passed": false,
      "message": "Found 28 PII fields without purpose documentation",
      "details": {
        "violations": [
          "AIFineTuningCommand.id collects PII without purpose documentation",
          "AIFineTuningFile.id collects PII without purpose documentation",
          "AIFineTuningTemplate.id collects PII without purpose documentation",
          "AnalysisSession.id collects PII without purpose documentation",
          "AnalysisSession.name collects PII without purpose documentation",
          "Dataset.id collects PII without purpose documentation",
          "Dataset.name collects PII without purpose documentation",
          "Page.id collects PII without purpose documentation",
          "Page.page_type collects PII without purpose documentation",
          "Payment.id collects PII without purpose documentation",
          "Payment.stripe_payment_intent_id collects PII without purpose documentation",
          "PrivacyPolicy.id collects PII without purpose documentation",
          "SubscriptionPlan.id collects PII without purpose documentation",
          "SubscriptionPlan.name collects PII without purpose documentation",
          "SubscriptionPlan.description collects PII without purpose documentation",
          "SubscriptionPlan.stripe_price_id_monthly collects PII without purpose documentation",
          "SubscriptionPlan.stripe_price_id_yearly collects PII without purpose documentation",
          "SubscriptionTierSettings.id collects PII without purpose documentation",
          "TermsOfService.id collects PII without purpose documentation",
          "TestResult.id collects PII without purpose documentation",
          "TestResult.test_name collects PII without purpose documentation",
          "TestResult.error_message collects PII without purpose documentation",
          "UserProfile.id collects PII without purpose documentation",
          "UserProfile.subscription_type collects PII without purpose documentation",
          "UserProfile.subscription_start collects PII without purpose documentation",
          "UserProfile.subscription_end collects PII without purpose documentation",
          "UserProfile.stripe_customer_id collects PII without purpose documentation",
          "UserProfile.stripe_subscription_id collects PII without purpose documentation"
        ]
      }
    },
    {
      "test_name": "third_party_pii_protection",
      "passed": false,
      "message": "Found 69 potential PII sharing with third parties",
      "details": {
        "violations": [
          "urls.py sends name to stripe",
          "urls.py sends email to stripe",
          "urls.py sends ip to stripe",
          "urls.py sends financial to stripe",
          "urls.py sends identifier to stripe",
          "views.py sends name to stripe",
          "views.py sends name to stripe",
          "views.py sends name to stripe",
          "views.py sends email to stripe",
          "views.py sends address to stripe"
        ]
      }
    }
  ]
}